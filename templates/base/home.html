{% extends 'base/main.html' %}
{% block content %}

<!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
<h1 style="text-align: center; margin-bottom: 15px">
  –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞
  <span style="color: var(--primary)">–ø—Ä–∞–∫—Ç–∏–∫—É Django —Å Nicat!</span>
</h1>
<p style="text-align: center; color: #475569; margin-bottom: 30px">
  –ó–¥–µ—Å—å –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è <strong>–≤—Å–µ –∫–æ–º–Ω–∞—Ç—ã</strong>, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.
</p>

<!-- –§–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ -->
<form method="GET" action="" style="max-width: 500px; margin: 0 auto 30px auto; display: flex; gap: 10px">
  <input
    type="text"
    name="q"
    placeholder="üîç –ü–æ–∏—Å–∫ –∫–æ–º–Ω–∞—Ç—ã..."
    value="{{ q }}"
    style="flex: 1; border-radius: var(--radius); padding: 10px; border: 1px solid #cbd5e1;"
  />
  <select name="filter_by" style="border-radius: var(--radius); padding: 10px; border: 1px solid #cbd5e1;">
    <option value="">–ë–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞</option>
    <option value="recent" {% if filter_by == 'recent' %}selected{% endif %}>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</option>
    <option value="topic" {% if filter_by == 'topic' %}selected{% endif %}>–ü–æ —Ç–µ–º–µ</option>
  </select>
  <button type="submit" class="button">–ü–æ–∏—Å–∫</button>
</form>

<!-- –¢–µ–º—ã -->
<section style="margin-bottom: 40px">
  <h2>–¢–µ–º—ã</h2>
  <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px">
    <a href="{% url 'home' %}" class="button button-secondary">–í—Å–µ</a>
    {% for topic in topics %}
      <a href="{% url 'home' %}?q={{ topic.name }}" class="button button-secondary">{{ topic.name }}</a>
    {% empty %}
      <p>–¢–µ–º –ø–æ–∫–∞ –Ω–µ—Ç.</p>
    {% endfor %}
  </div>
</section>

<!-- –°–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç -->
<section>
  <h2 style="margin-bottom: 15px">–ö–æ–º–Ω–∞—Ç—ã</h2>

  {% if request.user.is_authenticated %}
    <a href="{% url 'createRoom' %}" class="button" style="margin-bottom: 20px; display: inline-block">
      ‚ûï –°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É
    </a>
  {% endif %}

  {% if rooms %}
    {% for room in rooms %}
      <div class="room-card">
        <h3>
          <a href="{% url 'room_detail' room.id %}" style="color: var(--primary); text-decoration: none;">
            {{ room.name }}
          </a>
        </h3>

        {% if room.description %}
          <p>{{ room.description }}</p>
        {% endif %}

        <p style="font-size: 14px; color: #64748b">
          –ê–≤—Ç–æ—Ä: <strong>{{ room.host.username }}</strong> | –¢–µ–º–∞: <em>{{ room.topic.name }}</em>
        </p>

        {% if request.user == room.host %}
          <div style="margin-top: 10px">
            <a href="{% url 'updateRoom' room.id %}" class="button">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
            <a href="{% url 'deleteRoom' room.id %}" class="button button-secondary">–£–¥–∞–ª–∏—Ç—å</a>
          </div>
        {% endif %}
      </div>
    {% endfor %}
  {% else %}
    <p style="text-align: center; color: #64748b">–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç.</p>
  {% endif %}
</section>

{% endblock content %}